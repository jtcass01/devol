<?xml version="1.0"?>

<robot xmlns:xacro="http://wiki.ros.org/xacro">
    <!-- import macros -->
    <xacro:include filename="$(find a200_description)/urdf/a200.materials.xacro"/>
    <xacro:include filename= "$(find realsense2_description)/urdf/_d435.urdf.xacro"/>

    <xacro:macro name="a200" >
        <!-- Base link is the center of the robot's bottom plate -->
        <link name="a200_base_link">
            <visual>
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/clearpath_platform_description/meshes/a200/base_link.dae"/>
            </geometry>
            </visual>
            <collision>
            <origin rpy="0 0 0" xyz="0 0 0.061875"/>
            <geometry>
                <box size="0.9874 0.5709 0.12375"/>
            </geometry>
            </collision>
            <collision>
            <origin rpy="0 0 0" xyz="0 0 0.17562499999999998"/>
            <geometry>
                <box size="0.7899200000000001 0.5709 0.10375"/>
            </geometry>
            </collision>
        </link>
        <!-- Spawn A200 chassis -->
        <link name="top_chassis_link">
            <visual>
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/clearpath_platform_description/meshes/a200/top_chassis.dae"/>
            </geometry>
            </visual>
        </link>
        <!-- Attach chassis to the robot -->
        <joint name="top_chassis_joint" type="fixed">
            <parent link="a200_base_link"/>
            <child link="top_chassis_link"/>
        </joint>
        <!-- Inertial link stores the robot's inertial information -->
        <link name="inertial_link">
            <inertial>
            <mass value="46.034"/>
            <origin xyz="-0.00065 -0.085 0.062"/>
            <inertia ixx="0.6022" ixy="-0.02364" ixz="-0.1197" iyy="1.7386" iyz="-0.001544" izz="2.0296"/>
            </inertial>
        </link>
        <joint name="inertial_joint" type="fixed">
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <parent link="a200_base_link"/>
            <child link="inertial_link"/>
        </joint>
        <!-- Front Wheels -->
        <link name="front_left_wheel_link">
            <inertial>
            <mass value="2.637"/>
            <origin xyz="0 0 0"/>
            <inertia ixx="0.02084076477" ixy="0" ixz="0" iyy="0.035939686185" iyz="0" izz="0.02084076477"/>
            </inertial>
            <visual>
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/clearpath_platform_description/meshes/a200/wheels/outdoor.dae"/>
            </geometry>
            </visual>
            <collision>
            <origin rpy="1.570795 0 0" xyz="0 0 0"/>
            <geometry>
                <cylinder length="0.1143" radius="0.1651"/>
            </geometry>
            </collision>
        </link>
        <gazebo>
            <plugin filename="libgz-sim-wheel-slip-system.so" name="gz::sim::systems::WheelSlip">
            <wheel link_name="front_left_wheel_link">
                <slip_compliance_lateral>1.0</slip_compliance_lateral>
                <slip_compliance_longitudinal>1.0</slip_compliance_longitudinal>
                <wheel_normal_force>113</wheel_normal_force>
                <wheel_radius>0.1651</wheel_radius>
            </wheel>
            </plugin>
        </gazebo>
        <joint name="front_left_wheel_joint" type="continuous">
            <parent link="a200_base_link"/>
            <child link="front_left_wheel_link"/>
            <origin rpy="0 0 0" xyz="0.256 0.2775 0"/>
            <axis rpy="0 0 0" xyz="0 1 0"/>
        </joint>
        <link name="front_right_wheel_link">
            <inertial>
            <mass value="2.637"/>
            <origin xyz="0 0 0"/>
            <inertia ixx="0.02084076477" ixy="0" ixz="0" iyy="0.035939686185" iyz="0" izz="0.02084076477"/>
            </inertial>
            <visual>
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/clearpath_platform_description/meshes/a200/wheels/outdoor.dae"/>
            </geometry>
            </visual>
            <collision>
            <origin rpy="1.570795 0 0" xyz="0 0 0"/>
            <geometry>
                <cylinder length="0.1143" radius="0.1651"/>
            </geometry>
            </collision>
        </link>
        <gazebo>
            <plugin filename="libgz-sim-wheel-slip-system.so" name="gz::sim::systems::WheelSlip">
            <wheel link_name="front_right_wheel_link">
                <slip_compliance_lateral>1.0</slip_compliance_lateral>
                <slip_compliance_longitudinal>1.0</slip_compliance_longitudinal>
                <wheel_normal_force>113</wheel_normal_force>
                <wheel_radius>0.1651</wheel_radius>
            </wheel>
            </plugin>
        </gazebo>
        <joint name="front_right_wheel_joint" type="continuous">
            <parent link="a200_base_link"/>
            <child link="front_right_wheel_link"/>
            <origin rpy="0 0 0" xyz="0.256 -0.2775 0"/>
            <axis rpy="0 0 0" xyz="0 1 0"/>
        </joint>
        <!-- Rear Wheels -->
        <link name="rear_left_wheel_link">
            <inertial>
            <mass value="2.637"/>
            <origin xyz="0 0 0"/>
            <inertia ixx="0.02084076477" ixy="0" ixz="0" iyy="0.035939686185" iyz="0" izz="0.02084076477"/>
            </inertial>
            <visual>
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/clearpath_platform_description/meshes/a200/wheels/outdoor.dae"/>
            </geometry>
            </visual>
            <collision>
            <origin rpy="1.570795 0 0" xyz="0 0 0"/>
            <geometry>
                <cylinder length="0.1143" radius="0.1651"/>
            </geometry>
            </collision>
        </link>
        <gazebo>
            <plugin filename="libgz-sim-wheel-slip-system.so" name="gz::sim::systems::WheelSlip">
            <wheel link_name="rear_left_wheel_link">
                <slip_compliance_lateral>1.0</slip_compliance_lateral>
                <slip_compliance_longitudinal>1.0</slip_compliance_longitudinal>
                <wheel_normal_force>113</wheel_normal_force>
                <wheel_radius>0.1651</wheel_radius>
            </wheel>
            </plugin>
        </gazebo>
        <joint name="rear_left_wheel_joint" type="continuous">
            <parent link="a200_base_link"/>
            <child link="rear_left_wheel_link"/>
            <origin rpy="0 0 0" xyz="-0.256 0.2775 0"/>
            <axis rpy="0 0 0" xyz="0 1 0"/>
        </joint>
        <link name="rear_right_wheel_link">
            <inertial>
            <mass value="2.637"/>
            <origin xyz="0 0 0"/>
            <inertia ixx="0.02084076477" ixy="0" ixz="0" iyy="0.035939686185" iyz="0" izz="0.02084076477"/>
            </inertial>
            <visual>
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/clearpath_platform_description/meshes/a200/wheels/outdoor.dae"/>
            </geometry>
            </visual>
            <collision>
            <origin rpy="1.570795 0 0" xyz="0 0 0"/>
            <geometry>
                <cylinder length="0.1143" radius="0.1651"/>
            </geometry>
            </collision>
        </link>
        <gazebo>
            <plugin filename="libgz-sim-wheel-slip-system.so" name="gz::sim::systems::WheelSlip">
            <wheel link_name="rear_right_wheel_link">
                <slip_compliance_lateral>1.0</slip_compliance_lateral>
                <slip_compliance_longitudinal>1.0</slip_compliance_longitudinal>
                <wheel_normal_force>113</wheel_normal_force>
                <wheel_radius>0.1651</wheel_radius>
            </wheel>
            </plugin>
        </gazebo>
        <joint name="rear_right_wheel_joint" type="continuous">
            <parent link="a200_base_link"/>
            <child link="rear_right_wheel_link"/>
            <origin rpy="0 0 0" xyz="-0.256 -0.2775 0"/>
            <axis rpy="0 0 0" xyz="0 1 0"/>
        </joint>
        <gazebo>
            <plugin filename="libgz_ros2_control-system.so" name="gz_ros2_control::GazeboSimROS2ControlPlugin">
            <parameters>/home/jakeadelic/clearpath/platform/config/control.yaml</parameters>
            <ros>
                <remapping>~/odom:=platform/odom</remapping>
                <remapping>~/cmd_vel:=platform/cmd_vel</remapping>
                <remapping>/tf:=tf</remapping>
                <remapping>/tf_static:=tf_static</remapping>
                <remapping>/diagnostics:=diagnostics</remapping>
                <remapping>/dynamic_joint_states:=platform/dynamic_joint_states</remapping>
                <remapping>joint_states:=platform/joint_states</remapping>
                <remapping>~/reference:=platform/cmd_vel</remapping>
                <remapping>~/odometry:=platform/odom</remapping>
                <namespace>a200_0000</namespace>
            </ros>
            </plugin>
        </gazebo>
        <gazebo>
            <plugin filename="libgz-sim-pose-publisher-system.so" name="gz::sim::systems::PosePublisher">
            <publish_link_pose>true</publish_link_pose>
            <publish_nested_model_pose>true</publish_nested_model_pose>
            <use_pose_vector_msg>true</use_pose_vector_msg>
            <update_frequency>50</update_frequency>
            </plugin>
        </gazebo>
        <ros2_control name="a200_hardware" type="system">
            <hardware>
            <plugin>gz_ros2_control/GazeboSimSystem</plugin>
            </hardware>
            <joint name="front_left_wheel_joint">
            <command_interface name="velocity">
                <param name="min">-1</param>
                <param name="max">1</param>
            </command_interface>
            <state_interface name="position"/>
            <state_interface name="velocity"/>
            </joint>
            <joint name="rear_left_wheel_joint">
            <command_interface name="velocity">
                <param name="min">-1</param>
                <param name="max">1</param>
            </command_interface>
            <state_interface name="position"/>
            <state_interface name="velocity"/>
            </joint>
            <joint name="front_right_wheel_joint">
            <command_interface name="velocity">
                <param name="min">-1</param>
                <param name="max">1</param>
            </command_interface>
            <state_interface name="position"/>
            <state_interface name="velocity"/>
            </joint>
            <joint name="rear_right_wheel_joint">
            <command_interface name="velocity">
                <param name="min">-1</param>
                <param name="max">1</param>
            </command_interface>
            <state_interface name="position"/>
            <state_interface name="velocity"/>
            </joint>
        </ros2_control>
        <!-- Front bumper mount -->
        <link name="front_bumper_mount"/>
        <joint name="front_bumper_mount_joint" type="fixed">
            <origin rpy="0 0 0" xyz="0.406 0 0.091"/>
            <parent link="a200_base_link"/>
            <child link="front_bumper_mount"/>
        </joint>
        <!-- Rear bumper mount -->
        <link name="rear_bumper_mount"/>
        <joint name="rear_bumper_mount_joint" type="fixed">
            <origin rpy="0 0 3.14159" xyz="-0.406 0 0.091"/>
            <parent link="a200_base_link"/>
            <child link="rear_bumper_mount"/>
        </joint>
        <!-- Default mount -->
        <link name="default_mount"/>
        <joint name="default_mount_joint" type="fixed">
            <child link="default_mount"/>
            <parent link="a200_base_link"/>
            <origin xyz="0.0 0.0 0.224"/>
        </joint>
        <!-- Base footprint is on the ground under the robot -->
        <link name="base_footprint"/>
        <joint name="base_footprint_joint" type="fixed">
            <origin rpy="0 0 0" xyz="0 0 -0.13228"/>
            <parent link="a200_base_link"/>
            <child link="base_footprint"/>
        </joint>
        <!-- Attachments -->
        <!-- Spawn bumper link -->
        <link name="front_bumper_link">
            <visual>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/clearpath_platform_description/meshes/a200/attachments/bumper.dae"/>
            </geometry>
            </visual>
        </link>
        <link name="front_bumper_base_link"/>
        <joint name="front_bumper_base_joint" type="fixed">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="front_bumper_mount"/>
            <child link="front_bumper_base_link"/>
        </joint>
        <!-- Attach bumper -->
        <joint name="front_bumper_joint" type="fixed">
            <origin rpy="0 0 0" xyz="0.075 0 0"/>
            <parent link="front_bumper_base_link"/>
            <child link="front_bumper_link"/>
        </joint>
        <!-- Spawn bumper link -->
        <link name="rear_bumper_link">
            <visual>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/clearpath_platform_description/meshes/a200/attachments/bumper.dae"/>
            </geometry>
            </visual>
        </link>
        <link name="rear_bumper_base_link"/>
        <joint name="rear_bumper_base_joint" type="fixed">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="rear_bumper_mount"/>
            <child link="rear_bumper_base_link"/>
        </joint>
        <!-- Attach bumper -->
        <joint name="rear_bumper_joint" type="fixed">
            <origin rpy="0 0 0" xyz="0.075 0 0"/>
            <parent link="rear_bumper_base_link"/>
            <child link="rear_bumper_link"/>
        </joint>
        <!-- Spawn top plate -->
        <link name="top_plate_adjust_link"/>
        <link name="top_plate_link">
            <visual>
            <origin xyz="0 0 0"/>
            <material name="clearpath_dark_grey"/>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/clearpath_platform_description/meshes/a200/attachments/pacs_top_plate.stl"/>
            </geometry>
            </visual>
            <collision>
            <material name="clearpath_dark_grey"/>
            <origin rpy="0 0 0" xyz="0 0 0.003175"/>
            <geometry>
                <box size="0.67 0.59 0.00635"/>
            </geometry>
            </collision>
        </link>
        <!-- Attach PACS top plate -->
        <joint name="top_plate_adjust_joint" type="fixed">
            <child link="top_plate_adjust_link"/>
            <parent link="default_mount"/>
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
        </joint>
        <joint name="top_plate_joint" type="fixed">
            <child link="top_plate_link"/>
            <parent link="top_plate_adjust_link"/>
            <origin rpy="0.0 0.0 0.0" xyz="0.04825 0.0 0.0"/>
        </joint>
        <link name="top_plate_mount_d1"/>
        <joint name="top_plate_mount_d1_joint" type="fixed">
            <child link="top_plate_mount_d1"/>
            <parent link="top_plate_link"/>
            <origin xyz="0.28 0.0 0.00635"/>
        </joint>
        <link name="top_plate_mount_ur"/>
        <joint name="top_plate_mount_ur_joint" type="fixed">
            <child link="top_plate_mount_ur"/>
            <parent link="top_plate_link"/>
            <origin xyz="0.12 0.0 0.00635"/>
        </joint>
        <!-- Spawn the sensor arch link -->
        <link name="sensor_arch_link">
            <visual>
            <origin rpy="0 0 0" xyz="0 0 0.3"/>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/clearpath_platform_description/meshes/a200/attachments/300_mm_sensor_arch.dae"/>
            </geometry>
            </visual>
            <collision>
            <origin rpy="0 0 0" xyz="0 0 0.3"/>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/clearpath_platform_description/meshes/a200/attachments/300_mm_sensor_arch.dae"/>
            </geometry>
            </collision>
        </link>
        <link name="sensor_arch_mount"/>
        <!-- Attach the sensor arch to the top plate -->
        <joint name="sensor_arch_joint" type="fixed">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="default_mount"/>
            <child link="sensor_arch_link"/>
        </joint>
        <joint name="sensor_arch_mount_joint" type="fixed">
            <origin rpy="0 0 0" xyz="0 0 0.3"/>
            <parent link="sensor_arch_link"/>
            <child link="sensor_arch_mount"/>
        </joint>
        <!-- Links -->
        <link name="user_bay_cover_link">
            <visual>
            <geometry>
                <box size="0.4 0.4 0.002"/>
            </geometry>
            <material name="clearpath_dark_grey"/>
            </visual>
            <collision>
            <geometry>
                <box size="0.4 0.4 0.002"/>
            </geometry>
            <material name="clearpath_dark_grey"/>
            </collision>
        </link>
        <joint name="user_bay_cover_joint" type="fixed">
            <parent link="top_plate_link"/>
            <child link="user_bay_cover_link"/>
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.00735"/>
        </joint>
        <!-- Mounts -->
        <link name="fath_pivot_0_link">
            <visual>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/clearpath_mounts_description/meshes/fath_pivot_mount_base.dae"/>
            </geometry>
            <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
            </visual>
            <collision>
            <geometry>
                <box size="0.025 0.025 0.03"/>
            </geometry>
            <origin rpy="0 0 0" xyz="0 0 0.015"/>
            </collision>
            <collision>
            <geometry>
                <cylinder length="0.03" radius="0.04"/>
            </geometry>
            <origin rpy="1.5707963267948966 0 0" xyz="0 -0.035 0.0225"/>
            </collision>
        </link>
        <link name="fath_pivot_0_hinge_link">
            <visual>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/clearpath_mounts_description/meshes/fath_pivot_mount.dae"/>
            </geometry>
            <origin rpy="0 0 1.5707963267948966" xyz="0 0 0"/>
            </visual>
            <collision>
            <geometry>
                <box size="0.025 0.025 0.03"/>
            </geometry>
            <origin rpy="0 0 0" xyz="0 0 0.015"/>
            </collision>
        </link>
        <link name="fath_pivot_0_mount"/>
        <joint name="fath_pivot_0_joint" type="fixed">
            <parent link="sensor_arch_mount"/>
            <child link="fath_pivot_0_link"/>
            <origin rpy="3.1415 0.0 0.0" xyz="0.0 0.0 -0.021"/>
        </joint>
        <joint name="fath_pivot_0_hinge_joint" type="fixed">
            <parent link="fath_pivot_0_link"/>
            <child link="fath_pivot_0_hinge_link"/>
            <origin rpy="0 0.0 0" xyz="0 0 0.0225"/>
        </joint>
        <joint name="fath_pivot_0_mount_joint" type="fixed">
            <parent link="fath_pivot_0_hinge_link"/>
            <child link="fath_pivot_0_mount"/>
            <origin rpy="0 0 0" xyz="0 0 0.0225"/>
        </joint>
        <link name="bracket_0_link">
            <visual>
            <material name="clearpath_dark_grey"/>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/clearpath_mounts_description/meshes/pacs/bracket_horizontal.stl"/>
            </geometry>
            <origin rpy="0 0 0" xyz="0 0 0.010125"/>
            </visual>
            <collision>
            <origin rpy="0 0 0" xyz="0 0 0.0050625"/>
            <geometry>
                <box size="0.09 0.09 0.010125"/>
            </geometry>
            </collision>
        </link>
        <link name="bracket_0_mount"/>
        <joint name="bracket_0_joint" type="fixed">
            <child link="bracket_0_link"/>
            <parent link="top_plate_mount_d1"/>
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
        </joint>
        <joint name="bracket_0_mount_joint" type="fixed">
            <child link="bracket_0_mount"/>
            <parent link="bracket_0_link"/>
            <origin rpy="0 0 0" xyz="0 0 0.010125"/>
        </joint>
        <!-- Sensors -->
        <link name="lidar2d_0_link">
            <visual>
            <origin rpy="0 0 0" xyz="0 0 0"/>
            <geometry>
                <!-- Origin of this mesh is the base of the bracket. -->
                <mesh filename="file:///opt/ros/jazzy/share/clearpath_sensors_description/meshes/hokuyo_ust.stl"/>
            </geometry>
            <material name="clearpath_dark_grey"/>
            </visual>
        </link>
        <link name="lidar2d_0_laser">
            <inertial>
            <mass value="1.1"/>
            <origin xyz="0 0 0"/>
            <inertia ixx="0.00307156543804" ixy="0.0" ixz="0.0" iyy="0.0031284904152700005" iyz="0.0" izz="0.00196432421427"/>
            </inertial>
        </link>
        <joint name="lidar2d_0_joint" type="fixed">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="bracket_0_mount"/>
            <child link="lidar2d_0_link"/>
        </joint>
        <joint name="lidar2d_0_laser_joint" type="fixed">
            <!-- This offset is from the base of the bracket to the LIDAR's focal point. -->
            <origin rpy="0 0 0" xyz="0 0 0.0474"/>
            <parent link="lidar2d_0_link"/>
            <child link="lidar2d_0_laser"/>
        </joint>
        <gazebo reference="lidar2d_0_laser">
            <sensor name="lidar2d_0" type="gpu_lidar">
            <update_rate>40</update_rate>
            <visualize>true</visualize>
            <always_on>true</always_on>
            <gz_frame_id>lidar2d_0_laser</gz_frame_id>
            <topic>a200_0000/sensors/lidar2d_0/scan</topic>
            <lidar>
                <scan>
                <horizontal>
                    <samples>540</samples>
                    <resolution>1</resolution>
                    <min_angle>-2.356</min_angle>
                    <max_angle>2.356</max_angle>
                </horizontal>
                <vertical>
                    <samples>1</samples>
                    <resolution>1</resolution>
                    <min_angle>0</min_angle>
                    <max_angle>0</max_angle>
                </vertical>
                </scan>
                <range>
                <min>0.05</min>
                <max>25.0</max>
                <resolution>0.01</resolution>
                </range>
            </lidar>
            </sensor>
        </gazebo>
        <link name="lidar3d_0_link">
            <inertial>
            <mass value="0.83"/>
            <origin xyz="0 0 0.03585"/>
            <inertia ixx="0.000908059425" ixy="0" ixz="0" iyy="0.000908059425" iyz="0" izz="0.0011049624"/>
            </inertial>
            <visual>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/velodyne_description/meshes/VLP16_base_1.dae"/>
            </geometry>
            </visual>
            <visual>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/velodyne_description/meshes/VLP16_base_2.dae"/>
            </geometry>
            </visual>
            <collision>
            <origin rpy="0 0 0" xyz="0 0 0.03585"/>
            <geometry>
                <cylinder length="0.0717" radius="0.0516"/>
            </geometry>
            </collision>
        </link>
        <joint name="lidar3d_0_joint" type="fixed">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="sensor_arch_mount"/>
            <child link="lidar3d_0_link"/>
        </joint>
        <link name="lidar3d_0_laser">
            <inertial>
            <mass value="0.01"/>
            <origin xyz="0 0 0"/>
            <inertia ixx="1e-7" ixy="0" ixz="0" iyy="1e-7" iyz="0" izz="1e-7"/>
            </inertial>
            <visual>
            <origin xyz="0 0 -0.0377"/>
            <geometry>
                <mesh filename="file:///opt/ros/jazzy/share/velodyne_description/meshes/VLP16_scan.dae"/>
            </geometry>
            </visual>
        </link>
        <joint name="lidar3d_0_laser_joint" type="fixed">
            <origin rpy="0 0 0" xyz="0 0 0.0377"/>
            <parent link="lidar3d_0_link"/>
            <child link="lidar3d_0_laser"/>
        </joint>
        <gazebo reference="lidar3d_0_laser">
            <sensor name="lidar3d_0" type="gpu_lidar">
            <update_rate>20</update_rate>
            <visualize>true</visualize>
            <always_on>true</always_on>
            <gz_frame_id>lidar3d_0_laser</gz_frame_id>
            <topic>a200_0000/sensors/lidar3d_0/scan</topic>
            <lidar>
                <scan>
                <horizontal>
                    <samples>900</samples>
                    <resolution>1</resolution>
                    <min_angle>-3.141592</min_angle>
                    <max_angle>3.141592</max_angle>
                </horizontal>
                <vertical>
                    <samples>15</samples>
                    <resolution>1</resolution>
                    <min_angle>-0.261799</min_angle>
                    <max_angle>0.261799</max_angle>
                </vertical>
                </scan>
                <range>
                <min>0.9</min>
                <max>130.0</max>
                <resolution>0.01</resolution>
                </range>
            </lidar>
            </sensor>
        </gazebo>
        <!-- camera body, with origin at bottom screw mount -->
        <joint name="camera_0_joint" type="fixed">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="fath_pivot_0_mount"/>
            <child link="camera_0_bottom_screw_frame"/>
        </joint>
        <link name="camera_0_bottom_screw_frame"/>

        <xacro:sensor_d435 parent="camera_0_bottom_screw_frame" name="rear_camera" use_nominal_extrinsics="true">
            <origin rpy="3.14159 0 3.14159" xyz="0 0 0.022"/>
        </xacro:sensor_d435>

        <gazebo reference="rear_camera_color_frame">
            <sensor name="realsense_d435_camera" type="rgbd_camera">
                <camera>
                    <horizontal_fov>1.25</horizontal_fov>
                    <image>
                    <width>640</width>
                    <height>480</height>
                    </image>
                    <clip>
                    <near>0.3</near>
                    <far>100</far>
                    </clip>
                    <gz_frame_id>rear_camera_color_frame</gz_frame_id>
                    <optical_frame_id>rear_camera_color_frame</optical_frame_id>
                </camera>
                <always_on>1</always_on>
                <update_rate>30</update_rate>
                <visualize>true</visualize>
                <gz_frame_id>rear_camera_color_frame</gz_frame_id>
                <topic>a200_0000/sensors/camera_0</topic>
            </sensor>
        </gazebo>

        <gazebo>
            <plugin filename="gz-sim-diff-drive-system" name="gz::sim::systems::DiffDrive">
                <left_joint>front_left_wheel_joint</left_joint>
                <left_joint>rear_left_wheel_joint</left_joint>
                <right_joint>front_right_wheel_joint</right_joint>
                <right_joint>rear_right_wheel_joint</right_joint>
                <wheel_separation>0.555</wheel_separation>
                <wheel_radius>0.1651</wheel_radius>
                <odom_publish_frequency>30</odom_publish_frequency>
                <max_wheel_torque>2.0</max_wheel_torque>
                <max_wheel_acceleration>0.75</max_wheel_acceleration>
                <topic>/a200_0000/cmd_vel</topic>
                <odom_topic>/a200_0000/odom</odom_topic>
                <frame_id>odom</frame_id>
                <child_frame_id>a200_base_link</child_frame_id>
                <tf_topic>/model/a200_0000/tf</tf_topic>
                <publish_odom_tf>true</publish_odom_tf>
            </plugin>
        </gazebo>

        <gazebo>
            <plugin filename="gz-sim-joint-state-publisher-system" name="gz::sim::systems::JointStatePublisher">
                <topic>/a200_0000/dynamic_joint_states</topic>
            </plugin>
        </gazebo>

    </xacro:macro>
</robot>
